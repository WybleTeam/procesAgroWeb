<?php

namespace Proces\OficinasBundle\Entity;

use Doctrine\ORM\EntityRepository;

/**
 * MunicipioRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class MunicipioRepository extends EntityRepository
{                     
    public function findMunicipiosDepartamento($idDepartamento)
    {
        $em = $this->getEntityManager();
        $consulta = $em->createQuery('SELECT m.id, m.nombreMunicipio FROM OficinasBundle:Municipio m '
                . 'WHERE m.departamento = :idDepartamento');
        $consulta->setParameter('idDepartamento', $idDepartamento);
        
        $resultado = $consulta->getArrayResult();
        return $resultado;
    }

    public function findMunicipiostotal()
    {
        $em = $this->getEntityManager();
        $consulta = $em->createQuery('SELECT n.id, n.nombreMunicipio, d.id as codigo FROM OficinasBundle:Municipio n JOIN n.departamento d');
        
        $resultado = $consulta->getArrayResult();
        return $resultado;
    }
}
